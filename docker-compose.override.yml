version: '3.8'

# Docker Compose Override - Uses environment variables from .env file
# This file overrides hardcoded secrets in docker-compose.yml with secure .env values

services:
  postgres:
    environment:
      POSTGRES_PASSWORD: ${POSTGRES_PASSWORD}
  
  redis:
    command: redis-server --requirepass ${REDIS_PASSWORD}
  
  rabbitmq:
    environment:
      RABBITMQ_DEFAULT_PASS: ${RABBITMQ_PASSWORD}
  
  auth-service:
    environment:
      - ConnectionStrings__PostgreSQL=Host=postgres;Database=messenger_auth;Username=messenger_admin;Password=${POSTGRES_PASSWORD}
      - Jwt__Secret=${JWT_SECRET}
  
  message-service:
    environment:
      - ConnectionStrings__MessageDatabase=Host=postgres;Database=messenger_messages;Username=messenger_admin;Password=${POSTGRES_PASSWORD}
      - Jwt__SecretKey=${JWT_SECRET}
  
  user-service:
    environment:
      - ConnectionStrings__UserDatabase=Host=postgres;Database=messenger_users;Username=messenger_admin;Password=${POSTGRES_PASSWORD}
      - Jwt__SecretKey=${JWT_SECRET}
